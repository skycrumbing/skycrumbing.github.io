---
layout: post
title: 回调函数
tags:
- java
- 设计模式
categories: java
description: 利用Java实现回调函数
---

* 什么是回调函数
在java中，程序的执行其实是对象的互相调用，调用者（回调函数）定义了一个回调方法，被调用者执行这个回调方法，并将结果返回给调用者，这个就是回调  
* 为什么要用回调函数
当进行异步操作时，调用者可以同时处理多件事，回调方法就是用来通知并且处理某件事的返回结果
* 实现回调
Java要实现回调函数需要定义一个回调接口
```
package callback;

/**
 * Created by Administrator on 2018/9/28 0028.
 */
public interface CallBack {
    //这是一个回调方法，用于被调用者告知调用者结果
    public void callBack(String result);
}

```
回调函数实现这个接口，并定义回调方法
```
package callback;

/**
 * Created by Administrator on 2018/9/28 0028.
 */
public class Call implements CallBack {

    private Answer answer;

    public Call(Answer answer){
        this.answer = answer;
    }

    public void call(final  String question){
        new Thread(() -> {
            try {
                answer.answer(Call.this, question);
            } catch (InterruptedException e) {
                e.printStackTrace();
            }
        }).start();
        doSomething();

    }

    public void doSomething(){
        System.out.println("我是调用者，我调用了answer，我去干别的事了");
    }


    @Override
    public void callBack(String result) {
        System.out.println("被调用者得到结果，调用callBack返回结果，结果是=" + result);
    }
}
```
被调用者执行这个回调方法，将结果返回
```
package callback;

/**
 * Created by Administrator on 2018/9/28 0028.
 */
public class Answer {
    public void answer(CallBack callBack, String question) throws InterruptedException {
        System.out.println("我是Answer,被Call调用，要解决的问题是：" + question);
        System.out.println("但是Answer很忙，等Answer忙完");
        Thread.sleep(1000);

        String result = "2";
        System.out.println("好了，我给你算出来了");
        callBack.callBack(result);

    }
}

```
现在我们测试回调函数的执行
```
package callback;

/**
 * Created by Administrator on 2018/9/28 0028.
 */
public class Test {
    public static void main(String args[]){
        Answer answer = new Answer();
        Call call = new Call(answer);
        call.call("1 + 1");
    }


}

```


